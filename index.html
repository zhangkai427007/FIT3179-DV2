<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Malaysia: The Climate Challenge of Greenhouse Effect</title>

  <!-- Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@300;400;600;800&family=Merriweather:wght@400;700&display=swap" rel="stylesheet">

  <!-- Vega libs -->
  <script src="https://cdn.jsdelivr.net/npm/vega@6"></script>
  <script src="https://cdn.jsdelivr.net/npm/vega-lite@5"></script>
  <script src="https://cdn.jsdelivr.net/npm/vega-embed@7"></script>

  <style>
    :root{
      --bg:#f6fbf6;
      --card:#ffffff;
      --muted:#55606a;
      --accent:#123c4f;
      --accent-2:#1f7aa0; /* blue for intros */
      --maxWidth:1120px;
      --gap:20px;
      --readable:1.05rem;
    }
    html,body{height:100%; margin:0; padding:0; font-family:"Nunito", system-ui, -apple-system, "Segoe UI", Roboto, Arial; background:var(--bg); color:#0b2540;}
    .wrap{max-width:var(--maxWidth); margin:24px auto; padding:12px; box-sizing:border-box;}
    header{text-align:center;margin-bottom:14px;}
    h1{font-family:"Merriweather", serif; margin:0; font-size:2.3rem; font-weight:800; color:var(--accent);}

    main{display:grid; grid-template-columns: 1fr; gap:var(--gap); margin-top:18px;}

    .block{background:var(--card); border-radius:10px; padding:14px; box-shadow:0 8px 20px rgba(16,24,40,0.06); position:relative; overflow:visible;}
    .section-title{font-weight:700; margin:0 0 8px 0; color:#0b2540; font-size:1.06rem;}
    .section-sub{color:var(--muted); margin:0 0 12px 0; font-size:0.95rem;}

    .vis{
      width:100%;
      min-height:420px;
      display:flex;
      align-items:center;
      justify-content:center;
      background:linear-gradient(180deg, rgba(255,255,255,0.86), rgba(255,255,255,0.97));
      border-radius:8px;
      border:1px solid #eef3f3;
      box-sizing:border-box;
      padding:8px;
    }

    /* for charts that need extra top space so intro overlays don't cover content */
    .vis.with-intro { padding-top:96px; } /* general room for overlay */
    .vis.with-intro-sub { padding-top:140px; } /* more room for intro + subtext */
    .vis.large{ min-height:620px; height:620px; }

    /* overlay intro text (blue) — positioned relative to block */
    .chart-intro {
      position:absolute;
      z-index:10;
      left:22px;
      top:18px;
      background: rgba(255,255,255,0.97);
      padding:10px 12px;
      border-radius:8px;
      box-shadow: 0 6px 14px rgba(16,24,40,0.06);
      color:var(--accent-2);
      font-weight:700;
      font-size:1.02rem;
      line-height:1.2;
      pointer-events:none;
      max-width:46%;
    }
    .chart-intro.small { font-size:0.98rem; padding:8px 10px; max-width:46%; }
    .chart-intro.lower { top:58px; }

    .intro-sub {
      margin-top:10px;
      margin-left:22px;
      color:#123c4f;
      font-size:0.98rem;
      max-width:70%;
      font-weight:500;
    }

    .body-text { margin-top:12px; color:#123c4f; font-size:var(--readable); line-height:1.55; }

    /* glossary blue box (restored) */
    .glossary{ margin-top:12px; padding:12px; border-radius:8px; background: linear-gradient(180deg,#f7fbfc,#eef7fa); border-left:4px solid var(--accent-2); color:#0b4150; font-size:0.98rem; line-height:1.45;}
    .glossary strong{display:block; margin-bottom:6px;}

    footer.meta{margin-top:18px; color:var(--muted); font-size:0.88rem; text-align:center;}

    /* center embedded SVGs to avoid right-shift */
    .vis > * { width:100%; max-width:100%; display:block; margin:0 auto; box-sizing:border-box; }

    @media (max-width:900px){
      .vis{min-height:300px}
      .chart-intro, .chart-intro.lower { position:relative; left:auto; top:auto; margin-bottom:8px; max-width:100%; pointer-events:none; }
      .vis.with-intro { padding-top:18px; }
      .vis.with-intro-sub { padding-top:48px; }
      .intro-sub { margin-left:0; max-width:100%; }
    }
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <h1>Malaysia: The Climate Challenge of Greenhouse Effect</h1>
    </header>

    <main>
      <!-- 1 Temperature -->
      <section id="block-temperature" class="block">
        <div class="chart-intro" aria-hidden="false">Have you noticed that Malaysia is getting hotter?</div>

        <div id="vis-temperature" class="vis with-intro" role="img" aria-label="Temperature time series chart">Loading temperature chart…</div>

        <div class="body-text">
          Our senses don’t lie — in fact, Malaysia’s temperature is really increasing continually. Malaysia average surface temperature has risen from 25.76°C in 1901 to 27.06°C in 2024, a significant increase of 2.7°C. This warming trend extends to both the average maximum and minimum temperatures, which have also risen noticeably, signaling a broader climate shift.
        </div>
      </section>

      <!-- 2 Anomaly: keep blue intro and restore glossary box -->
      <section id="block-anomaly" class="block">
        <div class="chart-intro lower" aria-hidden="false">Malaysia’s climate is becoming increasingly strange!</div>

        <div id="vis-anomaly" class="vis with-intro" role="img" aria-label="Temperature anomaly chart">Loading anomaly chart…</div>

        <div class="body-text">
          While Malaysia experienced temperature anomaly before 2013, the temperature anomalies have been continuously increasing since 2013, using Malaysia’s 1991-2020 average surface temperature as a baseline.
        </div>

        <div class="glossary" role="note" aria-label="Glossary">
          <strong>Key terms</strong>
          <p><strong>Temperature Anomalies:</strong> The difference between a measured temperature and a reference or baseline temperature. Using data from 1991 to 2020 serves as reference, which is the most commonly used climate reference internationally.</p>
          <p><strong>Greenhouse Effect:</strong> A natural process where gases in Earth's atmosphere, like carbon dioxide and methane, trap the sun's heat, warming the planet's surface.</p>
          <p><strong>Greenhouse gases:</strong> Gases in Earth's atmosphere that trap heat, causing the greenhouse effect, which warms the planet.</p>
        </div>
      </section>

      <!-- 3 GHG: intro (blue) + intro-sub text (below) + larger padding for chart -->
      <section id="block-ghg" class="block">
        <div class="chart-intro small" aria-hidden="false">Who is the culprit behind the temperature rise?</div>
        <div class="intro-sub">The main reason for the rising temperatures is that greenhouse gases from human activities have worsened the 'greenhouse effect' on Earth.</div>

        <div id="vis-ghg" class="vis with-intro-sub" role="img" aria-label="Greenhouse gas emissions chart">Loading GHG emissions chart…</div>

        <div class="body-text">
          From 1990 to 2022, Malaysia's total greenhouse gas emissions have steadily increased, with electricity and heat production and the transport sector accounting for the largest shares. This ongoing rise in emissions will further intensify the greenhouse effect.
        </div>
      </section>

      <!-- 4 Sea level: title bolded -->
      <section id="block-searise" class="block">
        <div class="section-title"><strong>Sea Level — Seasonal Heatmap</strong></div>
        <div class="section-sub">In fact, greenhouse gases not only cause rising temperatures but also lead to sea level rise, threatening our homes!</div>

        <div id="vis-searise" class="vis large" role="img" aria-label="Sea level heatmap">Loading sea level heatmap…</div>

        <div class="body-text">
          Based on the heat map above, we can clearly find that as the years increase along the x-axis, the color of squares representing each month deepens, and even periodic tidal patterns become less distinct, indicating a continuous rise in sea levels around Malaysia.
        </div>
      </section>

      <!-- 5 Forest: blue intro repositioned to avoid covering chart -->
      <section id="block-forest" class="block">
        <div class="chart-intro small" style="top:12px; left:22px;">What can we do for Malaysia!</div>

        <div id="vis-forest" class="vis with-intro" role="img" aria-label="Forest reserve map">Loading forest reserve map…</div>

        <!-- insert filter chart below -->
        <div id="vis-filter" class="vis" style="margin-top:16px; min-height:420px;">Loading filter chart…</div>
      </section>

      <!-- concluding paragraphs after filter chart -->
      <section class="block">
        <div class="body-text" style="font-size:1.02rem; font-weight:700; margin-bottom:12px;">
          Through exploring the chart above, we see that as forest cover decreases yearly, Malaysia’s rainfall continues to rise. Facing the severe greenhouse effect challenge of the 21st century, our actions should focus on planting more trees, protecting the environment, and reducing carbon emissions!
        </div>

        <div class="body-text" style="font-size:0.98rem;">
          Although state governments in Malaysia are establishing Permanent Forest Reserves (PRF), the country’s total forest cover continues to decline. This is largely due to the complex network of forest protection, governed by multiple agencies and laws, where the federal agency JPSM lacks sufficient political accountability, leaving the creation of nature reserves, wildlife sanctuaries, and national parks mostly dependent on state legislation.
        </div>
      </section>

      <footer class="meta">Built with Vega-Lite & vega-embed. Last updated: <span id="updated-date"></span></footer>
    </main>
  </div>

  <script>
    // raw links
    const tempJSON  = "https://raw.githubusercontent.com/zhangkai427007/FIT3179-DV2/refs/heads/main/temperature.json";
    const anomJSON  = "https://raw.githubusercontent.com/zhangkai427007/FIT3179-DV2/refs/heads/main/anomaly.json";
    const ghgJSON   = "https://raw.githubusercontent.com/zhangkai427007/FIT3179-DV2/refs/heads/main/ghgemissions.json";
    const seariseJSON = "https://raw.githubusercontent.com/zhangkai427007/FIT3179-DV2/refs/heads/main/searise.json";
    const forestJSON  = "https://raw.githubusercontent.com/zhangkai427007/FIT3179-DV2/refs/heads/main/forestmap.json";
    const filterJSON  = "https://raw.githubusercontent.com/zhangkai427007/FIT3179-DV2/refs/heads/main/filter.json";

    async function embedChart(target, url, opts = {}) {
      const el = document.querySelector(target);
      if (!el) return;
      try {
        await vegaEmbed(target, url, {renderer:'svg', actions:true, ...opts});
        console.log("Embedded:", url);
      } catch (err) {
        console.error("Embed error:", url, err);
        el.innerText = "Unable to load chart — check console for details (CORS/404/JSON).";
      }
    }

    // embed charts
    embedChart('#vis-temperature', tempJSON);
    embedChart('#vis-anomaly', anomJSON);
    embedChart('#vis-ghg', ghgJSON);
    embedChart('#vis-searise', seariseJSON);
    embedChart('#vis-forest', forestJSON);
    embedChart('#vis-filter', filterJSON);

    document.getElementById('updated-date').textContent = new Date().toLocaleDateString();
  </script>
</body>
</html>




